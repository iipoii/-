##### 维纳滤波数学推导

假设我们有一个原始图像f(x, y)，经过模糊处理和加入噪声后得到了观测图像g(x, y)。我们可以将观测图像表示为：

```g(x, y) = h(x, y) * f(x, y) + n(x, y)```

其中h(x, y)表示退化函数，*表示卷积，傅里叶变化后为

```G(u, v) = H(u, v)F(u, v) + N(x, y)```


我们的目标是找到一个滤波器w(x, y)，使得观测图像g(x, y)滤波后的图像f'(x, y)与原始图像f(x, y)之间的均方误差最小化。我们可以定义误差函数E如下：

```E = E{[f'(x, y) - f(x, y)]^2}```

根据最小均方误差准则，我们希望最小化误差函数E。我们可以通过对误差函数E求导数，并令导数等于零，来求解滤波器w(x, y)。

具体推导如下：

1.将滤波器表示为频谱形式：

```W(u, v) = F'(u, v) / G(u, v)```

其中G(u, v)和F'(u, v)分别表示观测图像和滤波后的图像的傅里叶变换。

2.将滤波器的频谱形式代入误差函数E，并展开得到：

```
E = E{[F(u, v) - W(u, v) * G(u, v)]^2} 
= E{(F(u, v) - W(u, v) * [H(u, v)F(u, v) + N(x, y)])^2}
= E{(F(u, v)[1 - H(u, v)W(u, v)] - W(u, v)N(x, y))^2}
```

因为F与N不相关，因此平方的和可以写成和的平方
```上式 = E{(F(u, v)[1 - H(u, v)W(u, v)])^2} - E{[W(u, v)N(x, y)]^2} ```

只有图像和噪声是随机变量，因此
```上式 = [1 - H(u, v)W(u, v)]^2 * E[F(u, v)^2] - W(u, v)^2 * E[N(x, y)^2]```

3.对误差函数E求导数，并令导数等于零，得到：
```dE / dW*(u, v) = 0```

4.解方程，得到滤波器的频谱表示：
```W(u, v) = F*(u, v) * G(u, v) / (|F(u, v)|^2 + |N(u, v)|^2 / |G(u, v)|^2)```
